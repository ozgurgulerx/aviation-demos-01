apiVersion: v1
kind: ConfigMap
metadata:
  name: backend-config
  namespace: ${K8S_NAMESPACE}
data:
  # This file is rendered with envsubst before apply.
  # See scripts/render-k8s-manifests.sh and CI workflow.
  # Azure OpenAI Configuration
  AZURE_OPENAI_ENDPOINT: "${AZURE_OPENAI_ENDPOINT}"
  AZURE_OPENAI_API_VERSION: "${AZURE_OPENAI_API_VERSION}"
  AZURE_OPENAI_DEPLOYMENT_NAME: "${AZURE_OPENAI_DEPLOYMENT_NAME}"
  AZURE_OPENAI_WORKER_DEPLOYMENT_NAME: "${AZURE_OPENAI_WORKER_DEPLOYMENT_NAME}"
  AZURE_OPENAI_ORCHESTRATOR_DEPLOYMENT_NAME: "${AZURE_OPENAI_ORCHESTRATOR_DEPLOYMENT_NAME}"
  AZURE_OPENAI_REASONING_DEPLOYMENT_NAME: "${AZURE_OPENAI_REASONING_DEPLOYMENT_NAME}"
  AZURE_OPENAI_VISION_DEPLOYMENT_NAME: "${AZURE_OPENAI_VISION_DEPLOYMENT_NAME}"
  AZURE_REASONING_OPENAI_API_VERSION: "${AZURE_REASONING_OPENAI_API_VERSION}"
  AZURE_OPENAI_PROJECT_ENDPOINT: "${AZURE_OPENAI_PROJECT_ENDPOINT}"
  AZURE_FOUNDRY_PROJECT_ENDPOINT: "${AZURE_FOUNDRY_PROJECT_ENDPOINT}"
  AZURE_TEXT_EMBEDDING_DEPLOYMENT_NAME: "${AZURE_TEXT_EMBEDDING_DEPLOYMENT_NAME}"
  AZURE_OPENAI_TIMEOUT_SECONDS: "${AZURE_OPENAI_TIMEOUT_SECONDS}"
  AZURE_OPENAI_MAX_RETRIES: "${AZURE_OPENAI_MAX_RETRIES}"

  # Azure AI Search Configuration
  AZURE_SEARCH_ENDPOINT: "${AZURE_SEARCH_ENDPOINT}"

  # PII Container Configuration
  PII_ENDPOINT: "${PII_ENDPOINT}"
  PII_CONTAINER_ENDPOINT: "${PII_CONTAINER_ENDPOINT}"

  # PostgreSQL Configuration
  PGHOST: "${PGHOST}"
  PGPORT: "${PGPORT}"
  PGDATABASE: "${PGDATABASE}"
  PGUSER: "${PGUSER}"

  # Optional Fabric runtime endpoints (empty values allowed)
  FABRIC_KQL_ENDPOINT: "${FABRIC_KQL_ENDPOINT}"
  FABRIC_GRAPH_ENDPOINT: "${FABRIC_GRAPH_ENDPOINT}"
  FABRIC_NOSQL_ENDPOINT: "${FABRIC_NOSQL_ENDPOINT}"

  # Application Configuration
  FLASK_ENV: "${FLASK_ENV}"
  LOG_LEVEL: "${LOG_LEVEL}"
  SCHEMA_CACHE_TTL_SECONDS: "${SCHEMA_CACHE_TTL_SECONDS}"
  KQL_SCHEMA_MODE: "${KQL_SCHEMA_MODE}"
  OTEL_SERVICE_NAME: "${OTEL_SERVICE_NAME}"
  ENVIRONMENT: "${ENVIRONMENT}"
  AF_SESSION_TTL_SECONDS: "${AF_SESSION_TTL_SECONDS}"
  AF_MAX_SESSIONS: "${AF_MAX_SESSIONS}"
  GUNICORN_WORKER_CLASS: "${GUNICORN_WORKER_CLASS}"
  GUNICORN_WORKERS: "${GUNICORN_WORKERS}"
  GUNICORN_THREADS: "${GUNICORN_THREADS}"
  GUNICORN_TIMEOUT_SECONDS: "${GUNICORN_TIMEOUT_SECONDS}"
  GUNICORN_GRACEFUL_TIMEOUT_SECONDS: "${GUNICORN_GRACEFUL_TIMEOUT_SECONDS}"
  GUNICORN_KEEPALIVE_SECONDS: "${GUNICORN_KEEPALIVE_SECONDS}"
  GUNICORN_MAX_REQUESTS: "${GUNICORN_MAX_REQUESTS}"
  GUNICORN_MAX_REQUESTS_JITTER: "${GUNICORN_MAX_REQUESTS_JITTER}"
